# 1216-battery_temperature_prediction
Predicting cell temperature in a data-driven manner
## 可视化程序
for /l %x in (1, 0, 80) do (type result.txt) & (TIMEOUT /T 1) & CLS

# 01 单模型方案
## 数据处理方面
输入为初始温度，输出为999个时序的温度，每组数据集内包含了1000个时序。  
Encoder输入固定长度的10个序列，当预测的点数加上初始序列的长度小于10时，在后端补0。  
Decoder输入与Encoder类似，但会多一个下一时刻的电流与SOC值。
## 模型结构方面
在本方案中，构建了Encoder和Decoder。  
Encoder通过LSTM和Self-Attention对充电电流与SOC进行编码，生成q。  
Decoder先计算当前时刻测温点温度的均值与标准差，再通过Self-Attention对历史的各测点温度经过LayNorm之后进行编码，生成k和v。
通过全连接层对下一时刻的均值与标准差进行更新。使用Cross-Attention对qkv计算，得到分布，再与更新之后的均值与标准差进行计算，生成下一时刻的各测点温度。
## 当前结果
使用逐点累加的方式进行训练，但当点数增加到一定程度时，梯度爆炸，无法收敛，_**放弃了**_。

# 02 多模型方案
## 数据处理方面
load_data之后，不做任何处理，在各自的dataloader内进行处理。
## 模型结构方面
多模型包含了Pre_Encoder模型和All_Prediction模型。
Pre_Encoder用于对前半部分的温度分布进行预测，目前是预测七个测温点各自的温度。  
先计算初始温度的均值、方差和分布，然后通过Cross_Attention预测均值与方差随时间的变化，以及分布随时间的变化，最后进行反算。

# 03 Seq2Seq单模型方案
## 数据处理方面
load_data之后，不做任何处理，在各自的dataloader内进行处理。  
在dataloader内，用滑动窗口的方式提取数据。模型输入数据包含三个变量，分别是历史温度变化、历史电芯位置+电流+SOC变化和未来电芯位置+电流+SOC变化。
## 模型结构方面
包含两个LSTM，第一个LSTM用于对历史温度、电芯位置、电流和SOC进行编码，第二个LSTM用于基于当前电芯位置、电流和SOC进行解码。  
预测的是最大值的均值和方差，使用高斯负对数似然进行误差评估。  
效果不错！！

# 预测500时序
## 对118组测试集各组数据求取其均值，最大值和最小值，可得，平均均值误差为0.527K，平均最大值为1.257K，平均最小值为0.006K
![50-500.png](best_version%2F50-500.png)
# 预测1000时序
## 对38组测试集各组数据求取其均值，最大值和最小值，可得，平均均值误差为0.657K，平均最大值为1.646K，平均最小值为0.002K
![50-1000.png](best_version%2F50-1000.png)
